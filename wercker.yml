box: tcnksm/gox
build:
  steps:
    # Sets the go workspace and places you package
    # at the right place in the workspace tree
    - setup-go-workspace

    # golint
    - wercker/golint

    # Gets the dependencies
    - script:
        name: go get
        code: |
          go get

    # Build the project
    - tcnksm/gox:
        os: "darwin linux windows"
        arch: "386 amd64"

    # Archive executable files
    - tcnksm/zip:
        input: $WERCKER_OUTPUT_DIR/pkg
        output: $WERCKER_OUTPUT_DIR/dist

deploy:
  steps:
    # Create new release
    - wercker/github-create-release:
        token: $GITHUB_TOKEN
        tag: v1.0.0
    - wercker/github-upload-asset:
        token: $GITHUB_TOKEN
        file: dist/SHASUMS
    - wercker/github-upload-asset:
        token: $GITHUB_TOKEN
        file: dist/linux_386.zip
    - wercker/github-upload-asset:
        token: $GITHUB_TOKEN
        file: dist/linux_amd64.zip
    - wercker/github-upload-asset:
        token: $GITHUB_TOKEN
        file: dist/darwin_386.zip
    - wercker/github-upload-asset:
        token: $GITHUB_TOKEN
        file: dist/darwin_amd64.zip
    - wercker/github-upload-asset:
        token: $GITHUB_TOKEN
        file: dist/windows_386.zip
    - wercker/github-upload-asset:
        token: $GITHUB_TOKEN
        file: dist/windows_amd64.zip
